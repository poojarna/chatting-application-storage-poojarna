<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>IT3049 Chat</title>
        <!-- Bootstrap + JQuery + FontAwesome -->
        <link rel="stylesheet" href="resources/vendor/bootstrap.min.css" />
        <script src="resources/vendor/jquery-3.5.1.slim.min.js"></script>
        <script src="resources/vendor/popper.min.js"></script>
        <script src="resources/vendor/bootstrap.min.js"></script>
        <link rel="stylesheet" href="resources/vendor/fontawesome-free/css/all.min.css" />
        <link rel="stylesheet" href="resources/css/styles.css" />
        <style>
        body.dark-mode {
            background-color: #121212;
            color: #f1f1f1;
        }

        body.dark-mode .jumbotron {
            background-color: #1f1f1f;
            color: #fff;
        }

        body.dark-mode .input-group-text,
        body.dark-mode .form-control,
        body.dark-mode .btn {
            background-color: #2a2a2a;
            color: #f1f1f1;
            border-color: #444;
        }

        body.dark-mode .message {
            background-color: #333;
        }

        body.dark-mode .sender-info {
            color: #aaa;
        }
        </style>
    </head>

    <body>
        <header>
            <div class="jumbotron">
                <h1 class="display-4">IT-3049C Chat</h1>
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text">
                            <i class="fas fa-user"></i>
                        </span>
                    </div>
                <input id="my-name-input" type="text" class="form-control" placeholder="Name">
                <button id="save-name-button" class="btn btn-primary ml-2">Save Name</button>
                <div class="custom-control custom-switch ml-3">
                    <input type="checkbox" class="custom-control-input" id="darkModeToggle">
                    <label class="custom-control-label" for="darkModeToggle">Dark Mode</label>
                </div>
                </div>
            </div>
        </header>

        <div id="chat">

        <div class="mine messages">
            <div class="message">
                Dude
            </div>
        </div>

        <div class="yours messages">
            <div class="message">
                Hey!
            </div>
            <div class="sender-info">
                Someone 2:59PM
            </div>
        </div>

        <div class="yours messages">
            <div class="message">
                You there?
            </div>
                <div class="sender-info">
                Someone else 3:00PM
                </div>
            </div>

            <div class="yours messages">
                <div class="message">
                    Hello, how's it going? ðŸ˜€
                </div>
                <div class="sender-info">
                    Someone else2 3:02PM
                </div>
            </div>

            <div class="mine messages">
                <div class="message">
                    Great thanks!
                </div>
            </div>

            <div class="mine messages">
                <div class="message">
                    How about you?
                </div>
            </div>

            <div class="mine messages">
            <div class="message">
                Dude
            </div>
        </div>

        <div class="yours messages">
            <div class="message">
                Hey!
            </div>
            <div class="sender-info">
                Someone 2:59PM
            </div>
        </div>

        <div class="yours messages">
            <div class="message">
                You there?
            </div>
                <div class="sender-info">
                Someone else 3:00PM
                </div>
            </div>

            <div class="yours messages">
                <div class="message">
                    Hello, how's it going? ðŸ˜€
                </div>
                <div class="sender-info">
                    Someone else2 3:02PM
                </div>
            </div>

            <div class="mine messages">
                <div class="message">
                    Great thanks!
                </div>
            </div>

            <div class="mine messages">
                <div class="message">
                    How about you?
                </div>
            </div>
            <div class="mine messages">
            <div class="message">
                Dude
            </div>
        </div>

        <div class="yours messages">
            <div class="message">
                Hey!
            </div>
            <div class="sender-info">
                Someone 2:59PM
            </div>
        </div>

        <div class="yours messages">
            <div class="message">
                You there?
            </div>
                <div class="sender-info">
                Someone else 3:00PM
                </div>
            </div>

            <div class="yours messages">
                <div class="message">
                    Hello, how's it going? ðŸ˜€
                </div>
                <div class="sender-info">
                    Someone else2 3:02PM
                </div>
            </div>

            <div class="mine messages">
                <div class="message">
                    Great thanks!
                </div>
            </div>

            <div class="mine messages">
                <div class="message">
                    How about you?
                </div>
            </div>
            <div class="mine messages">
            <div class="message">
                Dude
            </div>
        </div>

        <div class="yours messages">
            <div class="message">
                Hey!
            </div>
            <div class="sender-info">
                Someone 2:59PM
            </div>
        </div>

        <div class="yours messages">
            <div class="message">
                You there?
            </div>
                <div class="sender-info">
                Someone else 3:00PM
                </div>
            </div>

            <div class="yours messages">
                <div class="message">
                    Hello, how's it going? ðŸ˜€
                </div>
                <div class="sender-info">
                    Someone else2 3:02PM
                </div>
            </div>

            <div class="mine messages">
                <div class="message">
                    Great thanks!
                </div>
            </div>

            <div class="mine messages">
                <div class="message">
                    How about you?
                </div>
            </div>
        </div>
        
        <footer>
        <div id="chatbar" class="input-group mb-3">
        <input
            type="text"
            id="my-message"
            class="form-control"
            placeholder="Type a message ..."
            disabled>
        <div class="input-group-append">
            <button
                class="btn btn-outline-primary"
                id="send-button"
                type="button"
                disabled>Send</button>
        </div>
        </div>

        </footer>

        <!-- Our own Scripts -->
        <script src="resources/js/index.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', function () {
            const nameInput = document.getElementById('my-name-input');
            const messageInput = document.getElementById('my-message');
            const sendButton = document.getElementById('send-button');
            const saveNameButton = document.getElementById('save-name-button');
            const toggle = document.getElementById('darkModeToggle');

            // Always start with chat disabled
            messageInput.disabled = true;
            sendButton.disabled = true;

            // If a name is stored, preload it but keep chat disabled until "Save Name"
            const savedName = localStorage.getItem('chatName');
            if (savedName) {
                nameInput.value = savedName;
            }

            // Save name and enable chat
            saveNameButton.addEventListener('click', () => {
                const name = nameInput.value.trim();
                if (name !== '') {
                    localStorage.setItem('chatName', name);
                    messageInput.disabled = false;
                    sendButton.disabled = false;
                    alert('Name saved! You can now send messages.');
                } else {
                    alert('Please enter your name.');
                }
            });

            // Allow user to modify name any time
            nameInput.addEventListener('input', () => {
                messageInput.disabled = true;
                sendButton.disabled = true;
            });

            // Dark mode toggle logic
            const prefersDark = localStorage.getItem('darkMode') === 'enabled';
            if (prefersDark) {
                document.body.classList.add('dark-mode');
                toggle.checked = true;
            }

            toggle.addEventListener('change', () => {
                if (toggle.checked) {
                    document.body.classList.add('dark-mode');
                    localStorage.setItem('darkMode', 'enabled');
                } else {
                    document.body.classList.remove('dark-mode');
                    localStorage.setItem('darkMode', 'disabled');
                }
            });
        });
        </script>


    </body>
</html>
